<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apple Glass ‚Äì Final</title>

<style>
/* ================= ROOT ================= */
:root{
  --glass-tint: rgba(255,255,255,0.35);
  --glass-bottom: rgba(255,255,255,0.18);
  --border: rgba(255,255,255,0.35);
}

/* ================= BACKGROUND ================= */
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",sans-serif;
  color:#111;

  background:
    linear-gradient(rgba(255,255,255,.15),rgba(255,255,255,.15)),
    url("https://images.unsplash.com/photo-1519681393784-d120267933ba");
  background-size:cover;
  background-position:center;
  background-attachment:fixed;

  transition:.4s;
}

body.dark{
  color:#eee;
  background:
    linear-gradient(rgba(0,0,0,.45),rgba(0,0,0,.45)),
    url("https://images.unsplash.com/photo-1519681393784-d120267933ba");
}

/* ================= CONTENT ================= */
main{
  padding:40px;
  max-width:900px;
  margin:auto;
}
.spacer{height:1400px}

/* ================= APPLE GLASS ================= */
.apple-glass{
  background-image:
    linear-gradient(180deg,var(--glass-tint),var(--glass-bottom)),
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.035'/%3E%3C/svg%3E");

  backdrop-filter: blur(36px) saturate(180%) contrast(110%);
  -webkit-backdrop-filter: blur(36px) saturate(180%) contrast(110%);

  border:1px solid var(--border);

  box-shadow:
    0 30px 70px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.45),
    inset 0 -1px 0 rgba(255,255,255,.12);
}

body.dark .apple-glass{
  --glass-tint: rgba(40,40,40,.75);
  --glass-bottom: rgba(20,20,20,.55);
  --border: rgba(255,255,255,.12);
}

/* ================= DOCK ================= */
#dock{
  position:fixed;
  bottom:18px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:14px;
  padding:14px 20px;
  border-radius:32px;
  z-index:1000;
}

.dock-btn{
  width:52px;
  height:52px;
  border-radius:50%;
  border:none;
  background:rgba(255,255,255,.28);
  font-size:22px;
  cursor:pointer;
  transition:
    transform .2s cubic-bezier(.22,1.4,.36,1),
    background .3s;
}

body.dark .dock-btn{background:rgba(255,255,255,.12)}

/* ================= SHEET ================= */
#sheet{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:78vh;
  border-radius:28px 28px 0 0;
  transform:translateY(100%);
  transition:transform .45s cubic-bezier(.22,1.4,.36,1);
  z-index:950;
  display:flex;
  flex-direction:column;
}
#sheet.open{transform:translateY(0)}

.sheet-handle{
  width:48px;height:6px;
  border-radius:4px;
  background:rgba(255,255,255,.65);
  margin:12px auto 6px;
}
.sheet-content{
  padding:20px;
  overflow:auto;
  flex:1;
}
.sheet-content li{
  list-style:none;
  padding:14px;
  margin-bottom:8px;
  border-radius:16px;
  background:rgba(255,255,255,.22);
}
body.dark .sheet-content li{background:rgba(255,255,255,.08)}

/* ================= BACKDROP ================= */
#backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.35);
  opacity:0;
  pointer-events:none;
  transition:.3s;
  z-index:900;
}
#backdrop.show{
  opacity:1;
  pointer-events:auto;
}

/* ================= MOBILE ONLY ================= */
@media(min-width:769px){#dock{display:none}}
</style>
</head>

<body>

<main>
  <h1>Apple-grade Glass UI</h1>
  <p>Dock magnification + elastic + adaptive glass</p>
  <div class="spacer"></div>
</main>

<!-- DOCK -->
<div id="dock" class="apple-glass">
  <button class="dock-btn">üè†</button>
  <button class="dock-btn" id="openSheet">üí¨</button>
  <button class="dock-btn" id="toggleDark">üåô</button>
</div>

<!-- BACKDROP -->
<div id="backdrop"></div>

<!-- SHEET -->
<div id="sheet" class="apple-glass">
  <div class="sheet-handle"></div>
  <div class="sheet-content">
    <ul>
      <li>Conversation 001</li>
      <li>Conversation 002</li>
      <li>Conversation 003</li>
      <li>Conversation 004</li>
      <li>Conversation 005</li>
    </ul>
  </div>
</div>

<script>
/* ================= SHEET ================= */
const sheet=document.getElementById("sheet");
const backdrop=document.getElementById("backdrop");
document.getElementById("openSheet").onclick=()=>{
  sheet.classList.add("open");
  backdrop.classList.add("show");
};
backdrop.onclick=closeSheet;
function closeSheet(){
  sheet.classList.remove("open");
  backdrop.classList.remove("show");
}

/* ================= SWIPE ELASTIC ================= */
let startY=0,drag=false;
sheet.addEventListener("touchstart",e=>{
  startY=e.touches[0].clientY;
  drag=true;
});
sheet.addEventListener("touchmove",e=>{
  if(!drag)return;
  let diff=e.touches[0].clientY-startY;
  if(diff>0) sheet.style.transform=`translateY(${diff*0.6}px)`;
});
sheet.addEventListener("touchend",e=>{
  drag=false;
  let diff=e.changedTouches[0].clientY-startY;
  if(diff>120) closeSheet();
  else sheet.style.transform="";
});

/* ================= DOCK MAGNIFICATION ================= */
const buttons=[...document.querySelectorAll(".dock-btn")];
document.getElementById("dock").addEventListener("mousemove",e=>{
  buttons.forEach(btn=>{
    const r=btn.getBoundingClientRect();
    const d=Math.abs(e.clientX-(r.left+r.width/2));
    const scale=Math.max(1,1.4-d/120);
    btn.style.transform=`scale(${scale}) translateY(${-(scale-1)*12}px)`;
  });
});
document.getElementById("dock").addEventListener("mouseleave",()=>{
  buttons.forEach(b=>b.style.transform="");
});

/* ================= DARK MODE ================= */
document.getElementById("toggleDark").onclick=()=>{
  document.body.classList.toggle("dark");
};

/* ================= ENVIRONMENT TINT ================= */
(function(){
  const img=new Image();
  img.crossOrigin="anonymous";
  img.src="https://images.unsplash.com/photo-1519681393784-d120267933ba";
  img.onload=()=>{
    const c=document.createElement("canvas");
    const x=c.getContext("2d");
    c.width=c.height=50;
    x.drawImage(img,0,0,50,50);
    const d=x.getImageData(0,0,50,50).data;
    let r=0,g=0,b=0;
    for(let i=0;i<d.length;i+=4){
      r+=d[i]; g+=d[i+1]; b+=d[i+2];
    }
    r=Math.round(r/(d.length/4));
    g=Math.round(g/(d.length/4));
    b=Math.round(b/(d.length/4));
    document.documentElement.style.setProperty(
      "--glass-tint",`rgba(${r},${g},${b},0.35)`
    );
  };
})();
</script>

</body>
</html>